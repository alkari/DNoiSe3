# DNoiSe3

**DNS noise generator that looks at your network activity and blends in. For [pi-hole](https://pi-hole.net) version 6+.**


![DNoiSe blended into organic traffic](https://github.com/jankais3r/DNoiSe/blob/master/traffic.png)

The blue graph line marks queries generated by DNoiSe, blending in with peaks and valleys of organic traffic.

This project aims to generate realistic-looking DNS traffic to make it harder for DNS providers and especially your Internet Service Provider (ISP) to profile your online activity based on your DNS requests. It achieves this by monitoring your Pi-hole's DNS query log and then generating additional DNS queries based on the observed rates.

This project is built on the original work of Jan Kaiser (jankais3r) in https://github.com/jankais3r/DNoiSe. It's an upgrade from Pi-hole v5.

The original DNoiSe.py is kept here to use with earlier versions of Pi-hole if preferred.

**Why bother?**

* **Privacy Concerns:** Your ISP can see every website you visit through your DNS queries. This information is incredibly valuable to them.
* **Targeted Advertising:** ISPs often use your DNS query data to build detailed profiles about your interests and habits. This allows them (or third-party advertisers they partner with) to target you with personalized advertisements, often without your explicit consent.
* **Data Monetization:** Alarmingly, many ISPs collect and aggregate user data, including DNS queries, and then sell this information on the open market to data brokers and advertising companies. This practice can compromise your privacy significantly.
* Does your DNS provider log your queries? If it does, you should consider changing your DNS provider. But if you can't, this will make it harder for them to profile you based on your DNS requests. Not impossible, but harder.
* Plausible deniability.

**How it works:**

1.  **Monitors Pi-hole:** The script connects to your Pi-hole server's API to fetch recent DNS queries.
2.  **Calculates Query Rate:** It analyzes the number of DNS queries within a recent time window (default: 5 minutes) to determine your network's DNS query rate.
3.  **Generates Noise:** Based on the calculated query rate, the script introduces additional DNS queries at a scaled-up rate. These queries are for domains randomly selected from a list of the top 1 million most popular websites.
4.  **Blends In:** The generated queries are intended to mimic real Browse activity, blending in with your legitimate DNS traffic patterns, thus making it more difficult for observers to distinguish your actual activity from the generated noise.

**Installation and Configuration:**

1.  **Prerequisites:**
    * Python 3.
    * `pip` package installer.
    * A running Pi-hole instance (v6) with the API enabled.
    * `requests` library: `pip install requests`
    * `dnspython` library: `pip install dnspython`
    * `pandas` library: `pip install pandas #for Raspberry Pi run 'sudo apt install python-pandas' instead.`
    * `python-dotenv` library: `pip install python-dotenv`

2.  **Download the script:** You can download the working version of the script named `DNoiSe3.py`.

3.  **Retrieve your Pi-hole API Password (APP_PASSWORD):**
        1.  Open the Pi-hole web interface.
        2.  Navigate to **Settings** in the left sidebar.
        3.  Click on the **API** tab.
	4.  Flip the switch on the top right to Expert.
	5.  Click "Configure app password"
        6.  Generate and copy the `APP_PASSWORD`.

4.  **Create a `.env` file:** In the same directory as the script, create a `.env` file with the following content, replacing `<your_pihole_api_password_or_token>` with the value you retrieved in the previous step:

    ```env
    APP_PASSWORD=<your_pihole_api_password_or_token>
    ```

5.  **Configuration within the script:**
    * **`WORKING_DIRECTORY`:** Set this to the directory where you've placed the script.
    * **`CLIENT_IP`:** Ensure this is set to the IP address of your Pi-hole server (default is `127.0.0.1`).
    * **`DNS_SERVER_IP`:** This should also be the IP address of your Pi-hole server (default is `127.0.0.1`), as the script uses it for resolving random domains.
    * **`LOG_FILE_PATH`:** Defines the location for the script's log file.
    * **`DEBUG_LOG_ENABLED`:** Set to `True` for more detailed logging during debugging, `False` for production.

6.  **Download the top 1M domain list (if it doesn't exist):** The script will automatically download and import the domain list into a SQLite database the first time it runs (or if the database file is not found). This requires an internet connection.

7.  **Run the script:** You can run the script from your terminal using:

    ```bash
    python3 DNoiSe3.py
    ```

**Running as a Service (Recommended):**

For continuous operation, it's recommended to run DNoiSe3 as a system service. Here's an example of a systemd service unit file (save it as `/lib/systemd/system/DNoiSe3.service`):

```ini
[Unit]
Description=DNoiSe3 DNS Noise Generator
After=network.target

[Service]
User=<your_username>
WorkingDirectory=/opt/DNoiSe/
ExecStart=/usr/bin/python3 /opt/DNoiSe/DNoiSe3.py
Restart=on-failure

[Install]
WantedBy=multi-user.target


Run the following:

```bash
sudo systemctl daemon-reload
sudo systemctl enable DNoiSe3.service
sudo systemctl start DNoiSe3.service
```
DNoiSe3.service is included. Copy that to /lib/systemd/system/.

You can then monitor DNoiSe3 with:

```bash
sudo systemctl status DNoiSe3.service
```
or:
```bash
sudo journalctl -u DNoiSe3.service -f
```
or:
```bash
tail -f /var/log/DNoiSe.log
```

Contributing:

Feel free to fork this repository and contribute to the project.

License:

This project is licensed under the MIT License. See the LICENSE file for details.

